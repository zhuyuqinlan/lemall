<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.zhuyuqinlan.lemall.business.admin.system.dao.UmsAdminDao">

    <select id="getResourceList" resultType="org.zhuyuqinlan.lemall.common.entity.UmsResource">
        SELECT DISTINCT ur.id          as id,
                        ur.create_time as createTime,
                        ur.`name`      as `name`,
                        ur.url         as url,
                        ur.description as description,
                        ur.category_id as categoryId
        FROM ums_admin_role_relation ar
                 LEFT JOIN ums_role r ON ar.role_id = r.id
                 LEFT JOIN ums_role_resource_relation rrr ON r.id = rrr.role_id
                 LEFT JOIN ums_resource ur ON ur.id = rrr.resource_id
        WHERE ar.admin_id = #{adminId}
          AND ur.id IS NOT NULL AND r.status = 1
    </select>

    <select id="getRoleList" resultType="org.zhuyuqinlan.lemall.common.entity.UmsRole">
        select r.*
        from ums_admin_role_relation ar
                 left join ums_role r on ar.role_id = r.id
        where ar.admin_id = #{adminId}
    </select>

    <select id="getPermissionList" resultType="org.zhuyuqinlan.lemall.common.entity.UmsPermission">
        SELECT p.*
        FROM ums_admin_permission_relation ap
        LEFT JOIN ums_permission p ON ap.permission_id = p.id
        WHERE ap.admin_id = #{id}
    </select>
</mapper>